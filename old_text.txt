        } else if (interaction.customId === MOVE_DM_BUTTON_ID) {
            await this.userConsentService.setDmPreference(userId, true);
            await interaction.reply({ content: 'Okay! I’ll reply in DMs from now on.', ephemeral: true });
        }
        } else if (interaction.customId === 'privacy_consent_agree') {
            // Handle privacy consent agreement
            try {
                await this.userConsentService.optInUser(userId, interaction.user.username || 'Unknown', {
                    consentToStore: true,
                    consentToAnalyze: true,
                    consentToPersonalize: true
                });
                await interaction.update({ 
                    content: '✅ Thank you! Privacy consent granted. You can now use all bot features. Try using `/chat` again!',
                    embeds: [], 
                    components: [] 
                });
            } catch (error) {
                logger.error('Failed to grant privacy consent', { userId, error });
                await interaction.reply({ 
                    content: '❌ Failed to save consent preferences. Please try again.',
                    ephemeral: true 
                });
            }
        } else if (interaction.customId === 'privacy_consent_decline') {
            // Handle privacy consent decline
            await interaction.update({ 
                content: '❌ Privacy consent declined. Some features will be limited. You can change your mind anytime using `/privacy` command.',
                embeds: [], 
                components: [] 
            });
